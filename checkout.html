<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8"/>
  <title>Оформление — Tesla-like AutoSale</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="nav-bar">
  <h2 onclick="location.href='index.html'">AutoSale</h2>
  <div class="nav-links">
    <a href="catalog.html" id="catalogLink">Каталог</a>
    <a href="contact.html" id="contactLink">Контакты</a>
    <a href="login.html"   id="loginLink">Войти</a>
    <a href="register.html"id="registerLink">Регистрация</a>
    <button id="logoutBtn" class="hidden">Выход</button>
    <button class="theme-toggle" onclick="toggleTheme()">Тема</button>
  </div>
</div>

<div class="form-container">
  <h1>Оформление покупки</h1>
  <p style="color:var(--subtext-color); margin-bottom:1rem;">Заполните шаги, чтобы завершить заказ</p>
  <form id="checkoutForm" onsubmit="event.preventDefault(); finishCheckout();">
    <!-- Шаг 1 -->
    <div class="step" id="step1">
      <label for="citySelect">Ваш город</label>
      <input type="text" id="citySelect" placeholder="Москва"/>

      <label>Тип доставки</label>
      <select id="deliverySelect">
        <option value="Самовывоз">Самовывоз</option>
        <option value="Доставка">Доставка до двери</option>
      </select>
    </div>

    <!-- Шаг 2 -->
    <div class="step" id="step2" style="display:none;">
      <label>Способ оплаты</label>
      <select id="paymentSelect">
        <option value="наличные">Наличные</option>
        <option value="карта">Банковская карта</option>
        <option value="кредит">Кредит/Рассрочка</option>
      </select>
    </div>

    <!-- Шаг 3 -->
    <div class="step" id="step3" style="display:none;">
      <p style="color:var(--subtext-color);">Проверьте данные и нажмите «Отправить»</p>
      <div id="summary" style="background:var(--input-bg); padding:1rem; border-radius:4px; margin-bottom:1rem;"></div>
    </div>

    <div class="form-nav">
      <button class="btn" type="button" id="prevBtn" onclick="changeStep(-1)">Назад</button>
      <button class="btn" type="button" id="nextBtn" onclick="changeStep(1)">Далее</button>
    </div>
  </form>
</div>

<footer>
  <p>© 2025 Авто-Сервис | Все права защищены</p>
</footer>

<script src="app.js"></script>
<script>
  let currentStep=1, totalSteps=3;
  const citySelect=document.getElementById('citySelect');
  const deliverySelect=document.getElementById('deliverySelect');
  const paymentSelect=document.getElementById('paymentSelect');
  const summary=document.getElementById('summary');

  window.addEventListener('load',()=>{
    initApp();
    showStep(currentStep);
  });

  function showStep(step){
    for(let i=1;i<=totalSteps;i++){
      const s=document.getElementById('step'+i);
      if(s) s.style.display='none';
    }
    document.getElementById('step'+ step).style.display='block';
    const prevBtn=document.getElementById('prevBtn');
    const nextBtn=document.getElementById('nextBtn');
    prevBtn.style.display=(step===1)?'none':'inline-block';
    nextBtn.textContent=(step===totalSteps)?'Отправить':'Далее';
    updateSummary();
  }

  function changeStep(n){
    if(n===1 && currentStep===totalSteps){
      finishCheckout();
      return;
    }
    currentStep+=n;
    if(currentStep<1) currentStep=1;
    if(currentStep>totalSteps) currentStep=totalSteps;
    showStep(currentStep);
  }

  function updateSummary(){
    summary.innerHTML=`
      <p><strong>Город:</strong> ${citySelect.value || "не указан"}</p>
      <p><strong>Доставка:</strong> ${deliverySelect.value}</p>
      <p><strong>Оплата:</strong> ${paymentSelect.value||"не выбрано"}</p>
    `;
  }

  function finishCheckout(){
    alert("Заказ оформлен!\n" + summary.innerText);
    location.href="index.html";
  }
</script>
</body>
</html>
